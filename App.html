
<html>
    <head>
        <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.21.7.js"></script>
    </head>
    <body>

        <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.21.7.js"></script>
        
        <!-- The orientation part -->
        <h1>Hi!</h1>
        <h3>First, turn the orientation on</h3>

        <script>
            function givePermission() {
              // feature detect
              if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                  .then(permissionState => {
                    if (permissionState === 'granted') {
                      window.addEventListener('deviceorientation', handleOrientation, true);
                    }
                  })
                  .catch(console.error);
              } else {
                // just serve up the EventListener w/o permissions here
               window.addEventListener('deviceorientation', handleOrientation, true);
              }
            }
          
            function handleOrientation(event)
            {
              var heading = event.alpha;
            
              // some browsers don't understand "alpha"
              if (typeof event.webkitCompassHeading !== "undefined") {
                 heading = event.webkitCompassHeading;
               }
          
              document.getElementById("heading").innerHTML = heading.toFixed([0]);
            }
          </script>
          
          <input type="button" value="Ok to see orientation" onClick="givePermission();" />
          <p>Your current orientation: </p><p id="heading">n/a</p>
          <hr/>


          
        <!-- The chat part -->
        <h3>You are in chat</h3>

        <form id="subform">
            <label>Send a message in the chat:</label>
            <input type="text" id="inputvalue" required></input>
            <input type="submit"></input>    
        </form>

        <!-- Instantiate PubNub -->
        <script type="text/javascript">
            var pubnubDemo = new PubNub({
                publishKey: 'pub-c-e8b82b68-be44-415e-80f8-c41c67c39f6b',
                subscribeKey: 'sub-c-3148dabe-85fd-11ea-9e86-0adc820ce981'
            });

            pubnubDemo.publish({ message: { "color" : "blue" }, channel: 'demo_tutorial' });
            pubnubDemo.publish({ message: 'hello', channel: 'demo_tutorial' });

            // Subscribe to the demo_tutorial channel pubnub
            pubnubDemo.addListener({
            message: function(message){
            console.log(message)
            }
            })

            pubnubDemo.subscribe({
            channels: ['demo_tutorial']
            });

            //sends a message
            const form = document.getElementById("subform")
            form.addEventListener("submit", function(event){
                const inputvalue = document.getElementById("inputvalue").value
                pubnubDemo.publish({ message: {inputvalue}, channel: 'demo_tutorial' }) 
                const thevalue = document.getElementById("inputvalue")
                thevalue.value = ''
            })
            
    </script>

    <div></div>

    

    <!-- <form id="subform" onsubmit="publishfunction()">
        <input type="text" name="inputvalue">
        </input>
        <input type="submit">
    </input>    
    </form> -->
    
    

    </body>
    </html>
    


    
    